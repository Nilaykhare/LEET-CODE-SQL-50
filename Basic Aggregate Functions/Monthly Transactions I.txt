
SELECT 
    DATE_FORMAT(trans_date, '%Y-%m') AS month,
    country, 
    count(trans_date) as trans_count,
    SUM(Case when state='approved' Then 1 else 0 End) as approved_count,
    sum(amount) as trans_total_amount,
    sum(Case when state='approved' Then amount else 0 End) as approved_total_amount 
FROM 
    Transactions
group by month, country 